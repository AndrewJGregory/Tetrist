{"version":3,"sources":["webpack:///webpack/bootstrap 8c9b198c4448c4b63db9","webpack:///./lib/util/piece_util.js","webpack:///./lib/util/collision_detection_util.js","webpack:///./lib/piece.js","webpack:///./lib/game.js","webpack:///./lib/util/main_util.js","webpack:///./lib/audio.js","webpack:///./lib/board.js","webpack:///./lib/main.js"],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA,mDAA2C,cAAc;;AAEzD;AACA;AACA;AACA;AACA;AACA;AACA,YAAI;AACJ;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;;;AC9DA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;;AAEA;AACA,OAAO,kBAAkB;AACzB;AACA;AACA;AACA;AACA;AAAA;AAAA;;AAEA;AACA;AACA;AAAA;AAAA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;;AAEA;AACA;AACA;AAAA;AAAA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;;AAEA;AACA;AACA;AAAA;AAAA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;;AAEA;AACA,SAAS,kBAAkB;AAC3B;AACA;AACA;AACA;AAAA;AAAA;;AAEA;AACA;AACA;;AAEA,iBAAiB,qCAAqC;AACtD;AACA;AACA;AACA;AACA,sBAAsB,SAAS;AAC/B;AACA;;AAEA;AACA;AAAA;AAAA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,mBAAmB;AACpC;AACA;AACA;AACA;AACA;AACA,kBAAkB,SAAS;AAC3B,0BAA0B,SAAS;AACnC;AACA;AACA;AACA;AAAA;AAAA;;AAEA;AACA,yBAAyB,MAAM;AAC/B;AACA;AACA;AAAA;AAAA;;AAEA;AACA;AACA;AACA,UAAU;AACV;AAAA;AAAA;;;;;;;;;AC7JA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AAAA;AAAA;;AAEA;AACA;AACA;AACA;AACA,iBAAiB,qCAAqC;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA,OAAO,kBAAkB;AACzB;AACA;AACA;AACA,iBAAiB,mBAAmB;AACpC;AACA;AACA;AACA;AACA;AACA,sBAAsB,SAAS;AAC/B;AACA;AACA;;AAEA;AACA;AAAA;AAAA;;AAEA;AACA,OAAO,kBAAkB;AACzB;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AAAA;AAAA;;;;;;;;;;AC9EA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,mCAAmC,WAAW;AAC9C;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;;;;;;AC9JA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,OAAO;AAC1B,qBAAqB,mBAAmB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,cAAc;AAC3B;AACA,yCAAyC,QAAQ;AACjD,yCAAyC,KAAK;AAC9C,0CAA0C,MAAM;AAChD;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA,mBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA,qBAAqB,OAAO;AAC5B;AACA;AACA;AACA;AACA;AACA,oCAAoC,EAAE,EAAE,EAAE;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;ACzQA;AACA;AACA;AACA;AAAA;AAAA;;;;;;;;ACHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,0CAA0C,KAAK;AAC/C;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,sBAAsB,KAAK;AAC3B;AACA;AACA;AACA;;AAEA;;;;;;;;;AC3CA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,mBAAmB,QAAQ;AAC3B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,oBAAoB,QAAQ;AAC5B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,mBAAmB,QAAQ;AAC3B,0BAA0B,EAAE;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,kDAAkD,WAAW;AAC7D;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAwB,OAAO;AAC/B;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA,mDAAmD,MAAM;AACzD,wBAAwB,MAAM;AAC9B;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;;;;AC5IA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,CAAC","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmory imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmory exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tObject.defineProperty(exports, name, {\n \t\t\tconfigurable: false,\n \t\t\tenumerable: true,\n \t\t\tget: getter\n \t\t});\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 7);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 8c9b198c4448c4b63db9","import * as collisionUtil from \"./collision_detection_util\";\n\nexport const generateFirstCollection = shapeId => {\n  const startXpos = 5;\n  let yPos = 18;\n  const orientation = 0;\n  const deltas = generatePieceDeltas(shapeId, orientation);\n  if (shapeId === 0) yPos = 19;\n  const collection = generateCollection(startXpos, yPos, deltas);\n  collection.attr(\"shape-id\", shapeId);\n  return collection;\n};\n\nexport const generateNextPiece = piece => {\n  let { startXpos, yPos } = getAttributes(piece);\n  const shapeId = piece.shapeId;\n  const collection = generateUserMoveCollection(piece, [0, -1]);\n  collection.attr(\"shape-id\", shapeId);\n  return collection;\n};\n\nexport const generateColor = shapeId => {\n  return COLORS[shapeId];\n};\n\nexport const COLORS = [\n  \"red\",\n  \"orange\",\n  \"yellow\",\n  \"blue\",\n  \"purple\",\n  \"white\",\n  \"pink\"\n];\n\nexport const generatePieceDeltas = (shapeId, orientation) => {\n  return pieceDeltas[shapeId][orientation];\n};\n\nexport const pieceDeltas = {\n  0: [\n    [[0, 0], [-1, 0], [1, 0], [2, 0]],\n    [[0, 0], [0, 1], [0, 2], [0, -1]],\n    [[0, 0], [-1, 0], [1, 0], [2, 0]],\n    [[1, 0], [1, 1], [1, 2], [1, -1]]\n  ],\n  1: [\n    [[0, 0], [1, 0], [-1, 0], [0, 1]],\n    [[0, 0], [0, 1], [0, -1], [-1, 0]],\n    [[0, 0], [0, -1], [-1, 0], [1, 0]],\n    [[0, 0], [0, 1], [0, -1], [1, 0]]\n  ],\n  2: [\n    [[0, 0], [0, 1], [1, 0], [1, 1]],\n    [[0, 0], [0, 1], [1, 0], [1, 1]],\n    [[0, 0], [0, 1], [1, 0], [1, 1]],\n    [[0, 0], [0, 1], [1, 0], [1, 1]]\n  ],\n  3: [\n    [[0, 0], [-1, 0], [1, 0], [1, 1]],\n    [[0, 0], [0, 1], [0, -1], [-1, 1]],\n    [[0, 0], [1, 0], [-1, 0], [-1, -1]],\n    [[0, 0], [0, 1], [0, -1], [1, -1]]\n  ],\n  4: [\n    [[0, 0], [-1, 0], [1, 0], [1, 1]],\n    [[0, 0], [0, -1], [0, 1], [-1, 1]],\n    [[0, 0], [1, 0], [-1, 0], [-1, -1]],\n    [[0, 0], [0, 1], [0, -1], [1, -1]]\n  ],\n  5: [\n    [[0, 0], [0, 1], [1, 1], [-1, 0]],\n    [[0, 0], [-1, 0], [-1, 1], [0, -1]],\n    [[0, 0], [0, -1], [1, 0], [-1, -1]],\n    [[0, 0], [0, 1], [1, 0], [1, -1]]\n  ],\n  6: [\n    [[0, 0], [0, 1], [-1, 1], [1, 0]],\n    [[0, 0], [0, 1], [-1, 0], [-1, -1]],\n    [[0, 0], [-1, 0], [0, -1], [1, -1]],\n    [[0, 0], [0, -1], [1, 0], [1, 1]]\n  ]\n  // 0: I, 1: T, 2: O, 3: J, 4: L, 5: S, 6: Z\n};\n\nexport const generateMoveDelta = decision => {\n  return moveDeltas[decision];\n};\n\nconst moveDeltas = {\n  left: [-1, 0],\n  right: [1, 0],\n  down: [0, -1]\n};\n\nexport const movePieceByUser = (decision, piece) => {\n  const delta = generateMoveDelta(decision);\n  const collection = generateUserMoveCollection(piece, delta);\n  const shapeId = piece.shapeId;\n  collection.attr(\"shape-id\", shapeId);\n  return collection;\n};\n\nexport const generateRotatedPiece = piece => {\n  const { startXpos, yPos } = getAttributes(piece);\n  const deltas = generatePieceDeltas(piece.shapeId, piece.orientation);\n  const collection = generateCollection(startXpos, yPos, deltas);\n  return collection;\n};\n\nexport const generateUserMoveCollection = (piece, delta) => {\n  const collection = $d();\n  let newSqPos, newSq, newYpos, newXpos, HTMLel;\n\n  for (let i = 0; i < piece.collection.HTMLels.length; i++) {\n    HTMLel = piece.collection.HTMLels[i];\n    newYpos = parseInt(HTMLel.getAttribute(\"y-pos\")) + delta[1];\n    newXpos = parseInt(HTMLel.getAttribute(\"x-pos\")) + delta[0];\n    newSqPos = String(newXpos) + String(newYpos);\n    newSq = $d(`.pos${newSqPos}`);\n    collection.concat(newSq);\n  }\n\n  return collection;\n};\n\nexport const generateCollection = (\n  startXpos,\n  yPos,\n  deltas,\n  isNextPiecePreview = true\n) => {\n  let collection = $d();\n  let newSqPos, newSq, newYpos, delta, newXpos;\n  for (let i = 0; i < deltas.length; i++) {\n    delta = deltas[i];\n    newYpos = yPos + delta[1];\n    newXpos = startXpos + delta[0];\n    newSqPos = String(newXpos) + String(newYpos);\n    newSq = isNextPiecePreview\n      ? $d(`.pos${newSqPos}`)\n      : $d(`.preview-pos${newSqPos}`);\n    collection.concat(newSq);\n  }\n  return collection;\n};\n\nexport const finalizePiece = (collection, color) => {\n  collection.addClass(`${color}`);\n  collection.addClass(\"moving\");\n  collection.attr(\"isPiece\", true);\n};\n\nexport const getAttributes = piece => {\n  let startXpos = parseInt(piece.collection.attr(\"x-pos\"));\n  let yPos = parseInt(piece.collection.attr(\"y-pos\"));\n  return { startXpos, yPos };\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/util/piece_util.js\n// module id = 0\n// module chunks = 0","import * as pieceUtil from \"./piece_util\";\n\nexport const shouldPieceBeMovedByUser = (decision, piece) => {\n  const delta = pieceUtil.generateMoveDelta(decision);\n  if (!isPieceInBounds(decision, piece)) {\n    return false;\n  }\n\n  const possibleNextPiece = pieceUtil.generateUserMoveCollection(piece, delta);\n  return !isCollision(piece.collection, possibleNextPiece);\n};\n\nconst isPieceInBounds = (decision, piece) => {\n  const delta = pieceUtil.generateMoveDelta(decision);\n  let collection = $d();\n  let newXpos, HTMLel, newYpos;\n  for (let i = 0; i < piece.collection.HTMLels.length; i++) {\n    HTMLel = piece.collection.HTMLels[i];\n    newXpos = parseInt(HTMLel.getAttribute(\"x-pos\")) + delta[0];\n    newYpos = parseInt(HTMLel.getAttribute(\"y-pos\")) + delta[1];\n    if (!areCoordinatesInBounds(newXpos, newYpos)) {\n      return false;\n    }\n  }\n  return true;\n};\n\nconst isCollision = (currentCollection, possibleNextCollection) => {\n  possibleNextCollection = possibleNextCollection.HTMLels.filter(HTMLel => {\n    return !currentCollection.HTMLels.includes(HTMLel);\n  });\n\n  const doesPieceOverlap = possibleNextCollection.some(\n    el => el.getAttribute(\"isPiece\") === \"true\"\n  );\n\n  return doesPieceOverlap;\n};\n\nconst areCoordinatesInBounds = (xPos, yPos) => {\n  if (xPos < 0 || xPos >= 10 || yPos < 0 || yPos >= 20) {\n    return false;\n  } else {\n    return true;\n  }\n};\n\nexport const shouldPieceRotate = (piece, newOrientation) => {\n  let { startXpos, yPos } = pieceUtil.getAttributes(piece);\n  const deltas = pieceUtil.generatePieceDeltas(piece.shapeId, newOrientation);\n  let possibleRotatedCollection = $d();\n  let newSqPos, newSq, newYpos, delta, newXpos;\n  for (let i = 0; i < deltas.length; i++) {\n    delta = deltas[i];\n    newYpos = yPos + delta[1];\n    newXpos = startXpos + delta[0];\n    if (!areCoordinatesInBounds(newXpos, newYpos)) return false;\n    newSqPos = String(newXpos) + String(newYpos);\n    newSq = $d(`.pos${newSqPos}`);\n    possibleRotatedCollection.concat(newSq);\n  }\n  if (isCollision(piece.collection, possibleRotatedCollection)) return false;\n\n  return true;\n};\n\nexport const shouldPieceMoveAgain = piece => {\n  let { startXpos, yPos } = pieceUtil.getAttributes(piece);\n  let shapeId = piece.shapeId;\n\n  if (!isPieceInBounds(\"down\", piece)) {\n    return false;\n  }\n\n  let possibleNextPiece = pieceUtil.generateUserMoveCollection(piece, [0, -1]);\n  const doesPieceCollide = isCollision(piece.collection, possibleNextPiece);\n\n  return !doesPieceCollide;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/util/collision_detection_util.js\n// module id = 1\n// module chunks = 0","import * as collisionUtil from \"./util/collision_detection_util\";\nimport * as pieceUtil from \"./util/piece_util\";\n\nclass Piece {\n  constructor() {\n    this.shapeId = Math.floor(Math.random() * 7);\n    this.intervalId = -1;\n    this.orientation = 0;\n    this.preview = $d();\n    this.dropped = false;\n    this.color = pieceUtil.COLORS[this.shapeId];\n    this.collection = pieceUtil.generateFirstCollection(this.shapeId);\n    this.drawed = false;\n  }\n\n  draw() {\n    pieceUtil.finalizePiece(this.collection, this.color);\n    this.drawed = true;\n  }\n\n  move() {\n    this.intervalId = window.setInterval(() => {\n      if (collisionUtil.shouldPieceMoveAgain(this)) {\n        this.removePreview();\n        this.removeCurrentPiece();\n        this.collection = pieceUtil.generateNextPiece(this);\n        this.draw();\n        this.setPreview();\n        this.drawPreview();\n      } else {\n        this.removePieceObject();\n      }\n    }, 200);\n  }\n\n  setPreview() {\n    this.preview = this.collection.dup();\n    let possibleNextCollection = this.collection.dup();\n    let doesCollide, shouldMoveAgain, duped;\n    while (true) {\n      duped = this.dup(possibleNextCollection);\n      shouldMoveAgain = collisionUtil.shouldPieceMoveAgain(duped);\n      if (shouldMoveAgain) {\n        this.preview = possibleNextCollection;\n        possibleNextCollection = pieceUtil.generateUserMoveCollection(duped, [\n          0,\n          -1\n        ]);\n      } else {\n        this.preview = possibleNextCollection;\n        break;\n      }\n    }\n  }\n\n  dup(collection) {\n    const copy = new Piece();\n    for (let variable in this)\n      copy[variable] = variable === \"collection\" ? collection : this[variable];\n    return copy;\n  }\n\n  drawPreview() {\n    this.preview.addClass(\"preview\");\n  }\n\n  removePreview() {\n    this.preview.removeClass(\"preview\");\n  }\n\n  removePieceObject() {\n    window.clearInterval(this.intervalId);\n    this.intervalId = -1;\n    this.collection.removeClass(\"moving\");\n    this.preview.removeClass(\"preview\");\n  }\n\n  removeCurrentPiece() {\n    this.collection.removeClass(`${this.color}`);\n    this.collection.removeClass(\"moving\");\n    this.collection.attr(\"isPiece\", false);\n  }\n\n  rotatePiece() {\n    const newOrientation = this._returnNewOrientation();\n    const shouldPieceRotate = collisionUtil.shouldPieceRotate(\n      this,\n      newOrientation\n    );\n    if (shouldPieceRotate) {\n      this._setOrientation();\n      this.removePreview();\n      this.removeCurrentPiece();\n      this.collection = pieceUtil.generateRotatedPiece(this);\n      this.draw();\n      this.setPreview();\n      this.drawPreview();\n    }\n  }\n\n  _returnNewOrientation() {\n    const newOrientation = (this.orientation + 1) % 4;\n    return newOrientation;\n  }\n\n  _setOrientation() {\n    this.orientation++;\n    this.orientation %= 4;\n  }\n\n  userMovePiece(decision) {\n    if (collisionUtil.shouldPieceBeMovedByUser(decision, this)) {\n      this.removeCurrentPiece();\n      this.collection = pieceUtil.movePieceByUser(decision, this);\n      this.draw();\n      this.removePreview();\n      this.setPreview();\n      this.drawPreview();\n    }\n  }\n\n  handleInput(keyPress) {\n    const decision = this._convertKeycodeToWord(keyPress.keyCode);\n    switch (decision) {\n      case \"rotate\":\n        if (!this.dropped) this.rotatePiece();\n        break;\n      case \"left\":\n      case \"right\":\n      case \"down\":\n        if (!this.dropped) this.userMovePiece(decision);\n        break;\n      case \"drop\":\n        const shapeId = this.collection.attr(\"shape-id\");\n        this.removeCurrentPiece();\n        this.collection = this.preview;\n        this.collection.attr(\"shape-id\", shapeId);\n        this.draw();\n        this.removePieceObject();\n        this.dropped = true;\n        break;\n      default:\n        return null;\n    }\n  }\n\n  _convertKeycodeToWord(keyCode) {\n    const keyCodesToWords = {\n      32: \"drop\", // spacebar\n      65: \"left\", // \"A\"\n      83: \"down\", // \"S\"\n      68: \"right\", // \"D\"\n      87: \"rotate\" // \"W\",\n    };\n    return keyCodesToWords[keyCode];\n  }\n}\n\nexport default Piece;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/piece.js\n// module id = 2\n// module chunks = 0","import Board from \"./board\";\nimport Piece from \"./piece\";\nimport * as pieceUtil from \"./util/piece_util\";\nimport * as collisionUtil from \"./util/collision_detection_util\";\nimport Audio from \"./audio\";\n\nclass Game {\n  constructor() {\n    this.board = new Board();\n    this.board.generate();\n    this.makePreviewSquare();\n    this.intervalId = -1;\n    this.pieces = [new Piece(), new Piece()];\n    this.currentPiece = this.pieces[1];\n    this.nextPiece = this.pieces[0];\n    this.gameOverModal = $d(\"#gameOverModal\").HTMLels[0];\n    this.playPauseModal = $d(\"#playPauseModal\").HTMLels[0];\n    this.submitBtn = $d(\".score-submit-btn\");\n    this.nameInput = $d(\".name-input\");\n    this.colors = pieceUtil.COLORS;\n    this.audio = new Audio();\n    this.paused = false;\n    this._initializeFirebase();\n    this.database = firebase.database();\n    window.firebase = null;\n    this.nameInput.on(\"keydown\", e => {\n      this.nameInput.removeClass(\"error\");\n      $d(\".name-input-error-msg\").html(\"\");\n    });\n  }\n\n  start() {\n    this.readFromDatabase();\n    $d(\".extra-game-over-text\").html(\"Submit your high score to play again.\");\n    $d(\"html\").off(\"keydown\");\n    $d(\"html\").on(\"keydown\", keyPress => this.handleInput(keyPress));\n    this.intervalId = window.setInterval(() => {\n      if (!this.isAnyPieceMoving()) {\n        this.currentPiece = this.pieces.pop();\n        this.drawNextPiecePreview();\n        this.nextPiece = new Piece();\n        this.pieces.unshift(this.nextPiece);\n        if (this.isOver()) {\n          this.endGame();\n        } else {\n          this.currentPiece.draw();\n          this.currentPiece.setPreview();\n          this.currentPiece.drawPreview();\n          this.currentPiece.move();\n          this.board.handleClearingOfRows();\n        }\n      }\n    }, 500);\n  }\n\n  isOver() {\n    const isAtTop = this.currentPiece.collection.HTMLels.some(\n      HTMLel => HTMLel.getAttribute(\"y-pos\") == 19\n    );\n    let isColliding;\n    const colors = pieceUtil.COLORS;\n    for (let i = 0; i < 4; i++) {\n      for (let j = 0; j < colors.length; j++) {\n        const color = colors[j];\n        if (this.currentPiece.collection.hasOneClass(color)) {\n          isColliding = true;\n        }\n      }\n    }\n    return isAtTop && isColliding;\n  }\n\n  isAnyPieceMoving() {\n    return $d(\".square\").hasOneClass(\"moving\");\n  }\n\n  endGame() {\n    window.clearInterval(this.intervalId);\n    this.gameOverModal.style.display = \"block\";\n    $d(\"html\").off(\"keydown\");\n    $d(\"html\").on(\"keydown\", keyPress => {\n      if (this.nameInput.HTMLels[0] !== document.activeElement) {\n        this.reset();\n        this.start();\n      }\n    });\n    this.submitBtn.on(\"click\", e => {\n      e.preventDefault();\n      const name = this.nameInput.val();\n      if (name) {\n        this.submitBtn\n          .html(\"Submitting...\")\n          .off(\"click\")\n          .removeClass(\"clickable\")\n          .addClass(\"not-allowed\");\n        this.saveScore(name);\n        $d(\".extra-game-over-text\").html(\"Press the spacebar to play again.\");\n      } else {\n        this.nameInput.addClass(\"error\");\n        $d(\".name-input-error-msg\").html(\"Name cannot be blank.\");\n      }\n    });\n  }\n\n  saveScore(name) {\n    const score = this.board.score;\n    this.database.ref(\"scores/\").push(\n      {\n        name,\n        score\n      },\n      () => {\n        this.submitBtn.html(\"Submitted!\");\n      }\n    );\n  }\n\n  reset() {\n    const allSquares = $d(\".square\");\n    this.colors.forEach(color => {\n      allSquares.removeClass(color);\n    });\n    allSquares\n      .addClass(\"green\")\n      .attr(\"isPiece\", false)\n      .attr(\"shape-id\", -1);\n    this.gameOverModal.style.display = \"none\";\n    this.board.score = 0;\n    $d(\".scoreCounter\").html(`Rows\\n cleared:\\n 0`);\n    $d(\"tbody\").html(\"\");\n    this.submitBtn\n      .removeClass(\"not-allowed\")\n      .addClass(\"clickable\")\n      .html(\"Submit score\");\n    this.nameInput.val(\"\");\n    this.currentPiece = null;\n  }\n\n  play() {\n    this.paused = false;\n    this.playPauseModal.style.display = \"none\";\n    this.currentPiece.move();\n  }\n\n  pause() {\n    if (\n      collisionUtil.shouldPieceMoveAgain(this.currentPiece) &&\n      this.currentPiece.drawed\n    ) {\n      this.paused = true;\n      this.playPauseModal.style.display = \"block\";\n      clearInterval(this.currentPiece.intervalId);\n      this.currentPiece.intervalId = -1;\n    }\n  }\n\n  handleInput(keyPress) {\n    const pieceKeycodes = [87, 65, 83, 68, 32];\n    const keycode = keyPress.keyCode;\n    if (keycode === 32 && this.paused) {\n      this.play();\n    } else {\n      if (keycode === 16) {\n        this.paused ? this.play() : this.pause();\n      } else {\n        if (pieceKeycodes.includes(keycode) && !this.paused)\n          this.currentPiece.handleInput(keyPress);\n      }\n    }\n  }\n\n  _initializeFirebase() {\n    const config = {\n      apiKey: \"AIzaSyCri3MSVxR5am0LcSauaI_VS4IB3g0fz2w\",\n      authDomain: \"tetrist-66fe1.firebaseapp.com\",\n      databaseURL: \"https://tetrist-66fe1.firebaseio.com\",\n      projectId: \"tetrist-66fe1\",\n      storageBucket: \"tetrist-66fe1.appspot.com\",\n      messagingSenderId: \"213202119525\"\n    };\n    firebase.initializeApp(config);\n  }\n\n  readFromDatabase() {\n    this.database\n      .ref(\"/scores/\")\n      .once(\"value\")\n      .then(snapshot => {\n        let data = Object.values(snapshot.val());\n        data.sort(this._compareByScore);\n        data = data.slice(0, 5);\n        this.makeHighScoreRows(data);\n      });\n  }\n\n  makeHighScoreRows(data) {\n    const tableBody = $d(\"tbody\");\n    let newRow, nameCell, scoreCell, position;\n    $d(\"div\").removeClass(\"loader\");\n    $d(\".loading-scores-msg\").html(\"\");\n    data.forEach((datum, idx) => {\n      const { name, score } = datum;\n      newRow = $d.create(\"tr\");\n      position = $d.create(\"td\").html(`${idx + 1}.`);\n      nameCell = $d.create(\"td\").html(`${name}`);\n      scoreCell = $d.create(\"td\").html(`${score}`);\n      newRow\n        .append(position)\n        .append(nameCell)\n        .append(scoreCell);\n      tableBody.append(newRow);\n    });\n  }\n\n  makePreviewSquare() {\n    const container = $d(\".preview-piece\");\n    const nextPieceHTMLel = $d.create(\"p\").html(\"Next piece: \");\n    container.append(nextPieceHTMLel);\n    let row;\n    for (let i = 0; i < 4; i++) {\n      row = $d\n        .create(\"div\")\n        .addClass(\"preview-row\")\n        .addClass(\"no-border\");\n      for (let j = 0; j < 4; j++) {\n        row.append(\n          $d\n            .create(\"div\")\n            .addClass(\"preview-square\")\n            .addClass(\"no-border\")\n            .addClass(`preview-pos${i}${j}`)\n            .attr(\"previewXpos\", i)\n            .attr(\"previewYpos\", j)\n        );\n      }\n      container.append(row);\n    }\n  }\n\n  drawNextPiecePreview() {\n    const collection = pieceUtil.generateCollection(\n      1,\n      1,\n      pieceUtil.generatePieceDeltas(this.nextPiece.shapeId, 1),\n      false\n    );\n    $d(\".preview-square\")\n      .addClass(\"no-border\")\n      .removeClass(this.currentPiece.color);\n    collection.removeClass(\"no-border\").addClass(this.nextPiece.color);\n  }\n\n  _compareByScore(elOne, elTwo) {\n    const result = elOne.score < elTwo.score;\n    switch (result) {\n      case true:\n        return 1;\n      case false:\n        return -1;\n      default:\n        return 0;\n    }\n  }\n}\n\nexport default Game;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/game.js\n// module id = 3\n// module chunks = 0","export const closeModal = (e, modal) => {\n  modal[0].style.display = \"none\";\n  $d(\"html\").off(\"click\");\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/util/main_util.js\n// module id = 4\n// module chunks = 0","class Audio {\n  constructor() {\n    this.element = $d(\"audio\").HTMLels[0];\n    this.container = $d(\".audio-controls\");\n    this.isPlaying = false;\n    this.container.on(\"click\", () => {\n      this.handleClick();\n    });\n  }\n\n  handleClick() {\n    this.isPlaying ? this.pause() : this.play();\n  }\n\n  play() {\n    this.isPlaying = true;\n    this.updateContent(\"pause\");\n    this.element.play();\n  }\n\n  pause() {\n    this.isPlaying = false;\n    this.updateContent(\"play\");\n    this.element.pause();\n  }\n\n  updateContent(type) {\n    this.container.empty();\n    const content = this.createContent(`${type}`);\n    this.container.append(content);\n  }\n\n  createContent(type) {\n    const content = $d.create(\"i\");\n    content\n      .addClass(\"fa\")\n      .addClass(\"fa-2x\")\n      .addClass(`fa-${type}`)\n      .attr(\"aria-hidden\", \"true\");\n    return content;\n  }\n}\n\nexport default Audio;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/audio.js\n// module id = 5\n// module chunks = 0","import * as pieceUtil from \"./util/piece_util\";\n\nclass Board {\n  constructor() {\n    this.board = $d(\"section\");\n    this.colors = pieceUtil.COLORS;\n    this.score = 0;\n  }\n\n  generate() {\n    this.generateRows();\n  }\n\n  generateSquares(row, y) {\n    let square;\n    for (let x = 0; x < 10; x++) {\n      square = this.createSquare(x, y);\n      row.append(square);\n    }\n  }\n\n  createSquare(x, y) {\n    const square = $d.create(\"div\").addClass(\"square\");\n    square.attr(\"x-pos\", x);\n    square.attr(\"y-pos\", y);\n    square.attr(\"isPiece\", false);\n    const position = \"pos\" + String(x) + String(y);\n    square.addClass(position);\n    return square;\n  }\n\n  generateRows() {\n    let row;\n    for (var y = 19; y >= 0; y--) {\n      row = this.createRow(y);\n      this.generateSquares(row, y);\n      this.board.append(row);\n    }\n  }\n\n  createRow(y) {\n    const row = $d.create(\"div\").addClass(\"row\");\n    row.attr(\"y-pos\", y);\n    const position = \"row-pos\" + String(y);\n    row.addClass(position);\n    return row;\n  }\n\n  handleClearingOfRows() {\n    let abovePieces, isRowFull, row;\n    for (let i = 0; i < 20; i++) {\n      row = $d(`.row-pos${i}`);\n      isRowFull = this.isRowFull(row);\n      if (isRowFull) {\n        this.clearRow(row);\n        this.updateScore();\n        abovePieces = this.getAbovePieces(i);\n        this.movePiecesDown(abovePieces);\n        i--;\n      }\n    }\n  }\n\n  updateScore() {\n    this.score++;\n    $d(\".scoreCounter\").html(`Rows\\n cleared:\\n ${this.score}`);\n  }\n\n  clearRow(row) {\n    let pieceColor;\n    row.children().HTMLels.forEach(el => {\n      pieceColor = this.colors.filter(color =>\n        Array.from(el.classList).includes(color)\n      )[0];\n\n      el.classList.remove(pieceColor);\n      el.setAttribute(\"shape-id\", -1);\n      el.setAttribute(\"isPiece\", false);\n    });\n  }\n\n  isRowFull(row) {\n    return row.children().HTMLels.reduce((acc, el) => {\n      return acc && el.getAttribute(\"isPiece\") === \"true\";\n    }, true);\n  }\n\n  movePiecesDown(allPieces) {\n    let oldYpos, newYpos, xPos, newPos, pieceColor, newSq;\n    allPieces.HTMLels.forEach(pieceSquare => {\n      oldYpos = parseInt(pieceSquare.getAttribute(\"y-pos\"));\n      newYpos = oldYpos - 1;\n      xPos = parseInt(pieceSquare.getAttribute(\"x-pos\"));\n      newPos = String(xPos) + String(newYpos);\n      pieceColor = this.colors.filter(color =>\n        Array.from(pieceSquare.classList).includes(color)\n      )[0];\n      pieceSquare.classList.remove(pieceColor);\n      pieceSquare.setAttribute(\"shape-id\", -1);\n      pieceSquare.setAttribute(\"isPiece\", false);\n      newSq = $d(`.pos${newPos}`);\n      newSq.addClass(pieceColor);\n      newSq.attr(\"isPiece\", true);\n    });\n  }\n\n  getAbovePieces(yPos) {\n    let abovePieces = $d();\n    let pieces;\n    this.colors.forEach(color => {\n      if (Array.from(document.querySelectorAll(`.${color}`)).length !== 0) {\n        pieces = $d(`.${color}`);\n        pieces.HTMLels = pieces.HTMLels.filter(el => {\n          return (\n            !Array.from(el.classList).includes(\"moving\") &&\n            parseInt(el.getAttribute(\"y-pos\")) > yPos\n          );\n        });\n        abovePieces.concat(pieces);\n      }\n    });\n    abovePieces.HTMLels.sort(this._compareByYpos);\n    return abovePieces;\n  }\n\n  _compareByYpos(elOne, elTwo) {\n    const result =\n      parseInt(elOne.getAttribute(\"y-pos\")) >\n      parseInt(elTwo.getAttribute(\"y-pos\"));\n    switch (result) {\n      case true:\n        return 1;\n      case false:\n        return -1;\n      default:\n        return 0;\n    }\n  }\n}\n\nexport default Board;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/board.js\n// module id = 6\n// module chunks = 0","import Piece from \"./piece\";\nimport Game from \"./game\";\nimport * as mainUtil from \"./util/main_util\";\n\ndocument.addEventListener(\"DOMContentLoaded\", () => {\n  const modal = document.querySelectorAll(\"#welcomeModal\");\n  $d(\"html\").on(\"keydown\", e => {\n    mainUtil.closeModal(e, modal);\n    const game = new Game();\n    game.start();\n  });\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./lib/main.js\n// module id = 7\n// module chunks = 0"],"sourceRoot":""}